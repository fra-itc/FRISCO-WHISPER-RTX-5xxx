<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Frisco Whisper RTX - GPU-accelerated transcription service">
    <title>{% block title %}Frisco Whisper RTX 5xxx{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EðŸŽ™ï¸%3C/text%3E%3C/svg%3E">

    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/style.css">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-microphone-alt"></i>
                <span>Frisco Whisper RTX</span>
                <span class="version">v1.3.0</span>
            </div>
            <div class="nav-links">
                <a href="/" class="nav-link {% block nav_upload %}{% endblock %}">
                    <i class="fas fa-upload"></i>
                    Upload
                </a>
                <a href="/jobs" class="nav-link {% block nav_jobs %}{% endblock %}">
                    <i class="fas fa-list"></i>
                    Jobs
                </a>
                <a href="/docs" target="_blank" class="nav-link">
                    <i class="fas fa-book"></i>
                    API Docs
                </a>
            </div>
            <div class="nav-status" id="gpuStatus">
                <i class="fas fa-circle-notch fa-spin"></i>
                <span>Checking GPU...</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Frisco Whisper RTX 5xxx</h4>
                    <p>GPU-accelerated speech-to-text transcription powered by OpenAI Whisper</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/docs">API Documentation</a></li>
                        <li><a href="/redoc">ReDoc</a></li>
                        <li><a href="https://github.com/openai/whisper" target="_blank">Whisper on GitHub</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>System Info</h4>
                    <ul id="systemInfo">
                        <li><i class="fas fa-circle-notch fa-spin"></i> Loading...</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Frisco Whisper RTX. Built with FastAPI and Faster-Whisper.</p>
            </div>
        </div>
    </footer>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- JavaScript -->
    <script src="/static/js/app.js"></script>

    <!-- Initialize system status -->
    <script>
        // Load system status on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadSystemStatus();
        });

        async function loadSystemStatus() {
            try {
                const response = await fetch('/api/v1/system/status');
                const data = await response.json();

                // Update GPU status in navbar
                const gpuStatus = document.getElementById('gpuStatus');
                if (data.gpu_available) {
                    gpuStatus.innerHTML = `
                        <i class="fas fa-check-circle" style="color: #00ff41;"></i>
                        <span>${data.gpu_name || 'GPU Active'}</span>
                    `;
                } else {
                    gpuStatus.innerHTML = `
                        <i class="fas fa-times-circle" style="color: #ff4444;"></i>
                        <span>CPU Mode</span>
                    `;
                }

                // Update system info in footer
                const systemInfo = document.getElementById('systemInfo');
                systemInfo.innerHTML = `
                    <li><i class="fas fa-microchip"></i> ${data.gpu_available ? 'GPU: ' + data.gpu_name : 'CPU Mode'}</li>
                    ${data.vram_gb ? `<li><i class="fas fa-memory"></i> VRAM: ${data.vram_gb.toFixed(1)} GB</li>` : ''}
                    ${data.cuda_version ? `<li><i class="fas fa-cog"></i> CUDA: ${data.cuda_version}</li>` : ''}
                    <li><i class="fas fa-brain"></i> Models: ${data.available_models.length}</li>
                `;
            } catch (error) {
                console.error('Failed to load system status:', error);
            }
        }
    </script>

    {% block extra_scripts %}{% endblock %}
</body>
</html>
